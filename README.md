
# User Account and Payment Management Services

## Introduction

Backend services to manage user accounts and their transactions. It comprises two main components: the Account Service and the Payment Service.

## Domains
### Account Manager Service
Deals with:
- User authentication
- User registration

### Payment Manager Service
Made for:
- Deposits, transfers, and withdrawals
- Transaction history

## Tech Stack
- Supabase (auth)
- Go + Gin Gonic
- Typescript + Fastify + Prisma
- PostgreSQL
- Nginx
- Docker compose

## Architecture
![architecture](https://cdn.discordapp.com/attachments/977196330189484042/1239065895188561971/Untitled_Diagram.drawio.png?ex=6641918a&is=6640400a&hm=267c84b9471a13480abc533f9c2d4c1d1c3f5b729f9df1681b090d3d7a79cec4&)

- Supabase as a third-party service that helps managing the authentication and authorization part of the system.
- Nginx wraps the API services to make them easier to access
- PostgreSQL is utilized to retain data (that are not handled by Supabase; e.g. transactions, payment accounts, etc.)
- Both services do not communicate directly, instead the payment manager accesses the token that is provided by Supabase, generated by authenticating through the account manager.

## API Reference
[swagger](https://app.swaggerhub.com/apis/TITAN170300/ConcreteAI-assignment/1.0.0)

## How to run

### Clone the project

```bash
  git clone https://github.com/titanrukmana/be-assignment.git
```

Go to the project directory

```bash
  cd my-project
```

### Add your own .env files
Please refer to the existing `.env.example` or see the instructions below:
1. root `.env`
```bash
  POSTGRES_USER=
  POSTGRES_PASSWORD=
  POSTGRES_DB=
  POSTGRES_PORT=
```

2. account_service `.env`
```bash
  SUPABASE_URL=
  SUPABASE_ANON_KEY=
```

3. payment_service `.env`
```bash
  DATABASE_USER=
  DATABASE_PASSWORD=
  DATABASE_DB=
  DATABASE_HOST=
  DATABASE_PORT=
  DATABASE_URL="postgresql://${DATABASE_USER}:${DATABASE_PASSWORD}@${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_DB}?schema=public"
  SUPABASE_URL=
  SUPABASE_ANON_KEY=
```


### Run docker-compose
Run this from the root directory:
```bash
  docker-compose up -d
```
